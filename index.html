<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vovinam - Khu Vực Đắk Lắk</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="header-content">
            <div class="mobile-header-top">
                <div class="logo-container" onclick="window.showSection('home')" title="Về trang chủ">
                    <img src="Logo_VVF.png" onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Vovinam_Logo.svg/1200px-Vovinam_Logo.svg.png'" alt="Logo" class="logo">
                    <h1 class="hide-on-mobile">Vovinam Ea M'droh</h1>
                </div>
                <button class="mobile-menu-btn" onclick="window.toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <nav id="main-nav">
                <ul class="main-menu">
                    <li onclick="window.showSection('home')"><a href="#">Trang chủ</a></li>
                    <li id="menu-history" style="display: none;" onclick="window.openHistorySection()">
                        <a href="#"><i class="fas fa-history"></i> <span id="menu-history-text">Lịch sử</span></a>
                    </li>
                    <li class="dropdown">
                        <a href="#">Câu Lạc Bộ <i class="fas fa-caret-down"></i></a>
                        <ul class="dropdown-content">
                            <li onclick="window.openClubManager('Nguyễn Huệ')"><a href="#">CLB Nguyễn Huệ</a></li>
                            <li onclick="window.openClubManager('Lê Hữu Trác')"><a href="#">CLB Lê Hữu Trác</a></li>
                            <li onclick="window.openClubManager('Nội Trú')"><a href="#">CLB Nội Trú</a></li>
                            <li onclick="window.openClubManager('Y Ngông')"><a href="#">CLB Y Ngông</a></li>
                            <li onclick="window.openClubManager('Hùng Vương')"><a href="#">CLB Hùng Vương</a></li>
                        </ul>
                    </li>
                    <li onclick="window.showSection('news')"><a href="#">Tin tức</a></li>
                    <li onclick="window.showSection('shop')"><a href="#">Cửa hàng <i class="fas fa-shopping-cart"></i></a></li>
                </ul>
            </nav>

            <div class="auth-buttons" id="auth-actions">
                <button class="btn-login" onclick="window.showSection('login')">Đăng Nhập</button>
                <button class="btn-register" onclick="window.showSection('register')">Đăng Ký</button>
            </div>
            
            <div class="user-info" id="user-display" style="display: none;">
                <div class="user-dropdown">
                    <button class="btn-user-menu">
                        <i class="fas fa-user-circle"></i> <span id="user-name-display">Tài khoản</span>
                    </button>
                    <ul class="user-dropdown-content">
                        <li onclick="window.showProfile()"><a href="#"><i class="fas fa-id-card"></i> Hồ sơ cá nhân</a></li>
                        <li onclick="window.logout()"><a href="#" style="color: red;"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="home" class="active-section">
            <div class="banner-slider-container">
                <button id="btn-config-banner" class="btn-config-banner" onclick="window.openBannerManager()" style="display: none;">
                    <i class="fas fa-cog"></i> Cài đặt Banner
                </button>
                <div id="banner-wrapper" class="banner-wrapper">
                    <div class="slide active">
                        <img src="https://vovinam.vn/wp-content/uploads/2019/04/vovinam-banner.jpg" alt="Default Banner">
                        <div class="banner-content">
                            <h2>TINH HOA VÕ THUẬT VIỆT NAM</h2>
                            <p>Rèn luyện thân thể - Tu dưỡng tinh thần</p>
                        </div>
                    </div>
                </div>
                <button class="slider-btn prev" onclick="window.moveSlide(-1)">&#10094;</button>
                <button class="slider-btn next" onclick="window.moveSlide(1)">&#10095;</button>
                <div id="slider-dots" class="slider-dots"></div>
            </div>

            <div class="club-slider">
                <h3>Các Câu Lạc Bộ Trực Thuộc</h3>
                <div class="slider-container">
                    <div class="club-card" onclick="window.openClubManager('Nguyễn Huệ')"><i class="fas fa-school"></i> <h4>CLB Nguyễn Huệ</h4></div>
                    <div class="club-card" onclick="window.openClubManager('Lê Hữu Trác')"><i class="fas fa-yin-yang"></i> <h4>CLB Lê Hữu Trác</h4></div>
                    <div class="club-card" onclick="window.openClubManager('Nội Trú')"><i class="fas fa-users"></i> <h4>CLB Nội Trú</h4></div>
                    <div class="club-card" onclick="window.openClubManager('Y Ngông')"><i class="fas fa-fist-raised"></i> <h4>CLB Y Ngông</h4></div>
                    <div class="club-card" onclick="window.openClubManager('Hùng Vương')"><i class="fas fa-dragon"></i> <h4>CLB Hùng Vương</h4></div>
                </div>
            </div>
        </section>

        <section id="login" style="display: none;">
            <div class="auth-container">
                <h2>Đăng Nhập</h2>
                <form id="login-form">
                    <div class="form-group"><label>Họ và tên:</label><input type="text" id="login-name" placeholder="Nhập họ tên" required></div>
                    <div class="form-group"><label>Số điện thoại:</label><input type="number" id="login-phone" placeholder="Nhập số điện thoại" required></div>
                    <button type="submit" class="btn-submit">Đăng Nhập</button>
                    <p class="auth-link">Chưa có tài khoản? <a href="#" onclick="window.showSection('register')">Đăng ký ngay</a></p>
                </form>
            </div>
        </section>

        <section id="register" style="display: none;">
            <div class="auth-container">
                <h2>Đăng Ký Thành Viên</h2>
                <form id="register-form">
                    <div class="form-group"><label>Họ và tên:</label><input type="text" id="reg-name" placeholder="Nhập họ và tên..." required></div>
                    <div class="form-group"><label>Số điện thoại:</label><input type="number" id="reg-phone" placeholder="Tối đa 10 số" maxlength="10" required></div>
                    <div class="form-group"><label>Ngày sinh:</label><input type="date" id="reg-dob" required></div>
                    
                    <div class="form-group">
                        <label>Cấp đai hiện tại:</label>
                        <select id="reg-belt" required>
                            <option value="Tự vệ">Đai Tự Vệ (Nhập môn)</option>
                            <option value="Lam đai">Lam đai</option>
                            <option value="Lam đai I">Lam đai I</option>
                            <option value="Lam đai II">Lam đai II</option>
                            <option value="Lam đai III">Lam đai III</option>
                            <option value="Chuẩn hoàng đai">Chuẩn hoàng đai</option>
                            <option value="Hoàng đai">Hoàng đai</option>
                            <option value="Hoàng đai I">Hoàng đai I</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Chọn Câu Lạc Bộ:</label>
                        <select id="reg-club" required onchange="window.toggleRegisterFields()">
                            <option value="">-- Chọn CLB --</option>
                            <option value="Nguyễn Huệ">CLB Nguyễn Huệ</option>
                            <option value="Lê Hữu Trác">CLB Lê Hữu Trác</option>
                            <option value="Nội Trú">CLB Nội Trú</option>
                            <option value="Y Ngông">CLB Y Ngông</option>
                            <option value="Hùng Vương">CLB Hùng Vương</option>
                        </select>
                    </div>

                    <div class="form-group" id="reg-class-wrapper" style="display: none;">
                        <label style="color:var(--vovinam-blue)">Chọn Lớp (Dành cho Nội Trú):</label>
                        <select id="reg-class">
                            <option value="">-- Chọn Lớp --</option>
                            <option value="6">Lớp 6</option>
                            <option value="7">Lớp 7</option>
                            <option value="8">Lớp 8</option>
                            <option value="9">Lớp 9</option>
                        </select>
                    </div>

                    <button type="submit" class="btn-submit">Đăng Ký Tham Gia</button>
                </form>
            </div>
        </section>

        <section id="club-manager" style="display: none;">
            <h2 id="current-club-title" class="section-title">Quản lý CLB</h2>
            <div id="club-assistants-display" style="text-align: center; color: #0055A4; margin-bottom: 15px; font-style: italic; font-weight: 500;"></div>

            <div class="club-tabs">
                <button class="tab-btn active" id="btn-tab-attendance" onclick="window.switchTab('attendance')">Điểm Danh</button>
                <button class="tab-btn" id="btn-add-student" onclick="window.switchTab('add-student')">Thêm Môn Sinh</button>
            </div>
            
            <div id="tab-add-student" class="tab-content" style="display: none;">
                <div class="bulk-upload-area" style="background: #e3f2fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; border: 1px dashed #0055A4;">
                    <h4><i class="fas fa-file-upload"></i> Nhập danh sách nhanh (Excel/CSV)</h4>
                    <p style="font-size: 0.9rem; color: #555;">File mẫu: <b>Họ tên, Số điện thoại, Ngày sinh, Cấp đai, Lớp</b> (Lưu UTF-8)</p>
                    <input type="file" id="bulk-upload-input" accept=".csv, .txt">
                    <button type="button" class="btn-bulk-upload" onclick="window.handleBulkUpload()">Tải lên danh sách</button>
                    <button type="button" class="btn-delete-all" onclick="window.deleteAllStudents()" style="margin-left: 10px; background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        <i class="fas fa-trash-alt"></i> Xóa TOÀN BỘ
                    </button>
                </div>
                <hr>

                <form id="add-student-form" onsubmit="window.handleAddStudent(event)">
                    <div class="form-group"><label>Họ và tên:</label><input type="text" id="student-name" required></div>
                    <div class="form-group"><label>Số điện thoại:</label><input type="number" id="student-phone" required></div>
                    <div class="form-group"><label>Ngày sinh:</label><input type="date" id="student-dob" required></div>
                    
                    <div class="form-group">
                        <label>Cấp đai:</label>
                        <select id="student-belt" required>
                            <option value="Tự vệ">Đai Tự Vệ</option>
                            <option value="Lam đai">Lam đai</option>
                            <option value="Lam đai I">Lam đai I</option>
                            <option value="Lam đai II">Lam đai II</option>
                            <option value="Lam đai III">Lam đai III</option>
                            <option value="Chuẩn hoàng đai">Chuẩn hoàng đai</option>
                            <option value="Hoàng đai">Hoàng đai</option>
                            <option value="Hoàng đai I">Hoàng đai I</option>
                        </select>
                    </div>

                    <div class="form-group" id="student-class-wrapper" style="display: none;">
                        <label style="color:var(--vovinam-blue)">Lớp (Chỉ Nội Trú):</label>
                        <select id="student-class">
                            <option value="">-- Chọn Lớp --</option>
                            <option value="6">Lớp 6</option>
                            <option value="7">Lớp 7</option>
                            <option value="8">Lớp 8</option>
                            <option value="9">Lớp 9</option>
                        </select>
                    </div>

                    <div class="form-group"><label>Ảnh đại diện (Dưới 5MB):</label><input type="file" id="student-img" accept="image/*"></div>
                    <button type="submit" class="btn-submit">Thêm vào danh sách</button>
                </form>
            </div>

            <div id="tab-attendance" class="tab-content">
                <div id="attendance-toolbar" class="attendance-toolbar" style="display: none;">
                    <div class="filter-group">
                        <select id="filter-class-select" style="display: none; border-color: var(--vovinam-blue);" onchange="window.renderAttendanceTable()">
                            <option value="ALL">-- Tất cả Lớp --</option>
                            <option value="6">Lớp 6</option>
                            <option value="7">Lớp 7</option>
                            <option value="8">Lớp 8</option>
                            <option value="9">Lớp 9</option>
                        </select>

                        <select id="filter-belt-select" onchange="window.renderAttendanceTable()">
                            <option value="ALL">-- Tất cả cấp đai --</option>
                            <option value="Tự vệ">Đai Tự Vệ</option>
                            <option value="Lam đai">Lam đai (Các cấp)</option>
                            <option value="Hoàng đai">Hoàng đai (Các cấp)</option>
                        </select>
                        <button class="btn-tool btn-sort" onclick="window.toggleSortName()" title="Sắp xếp tên A-Z">
                            <i class="fas fa-sort-alpha-down"></i> Tên
                        </button>
                    </div>
                    <div class="action-group">
                        <button class="btn-tool btn-export" onclick="window.exportToExcel()" title="Tải danh sách về máy">
                            <i class="fas fa-file-excel"></i> Xuất
                        </button>
                    </div>
                </div>

                <div class="table-responsive">
                    <table id="attendance-table">
                        <thead><tr><th>STT</th><th>Thông tin</th><th>Trạng Thái</th><th>Ghi chú</th></tr></thead>
                        <tbody id="attendance-list"></tbody>
                    </table>
                </div>
                <div id="empty-list-msg" style="text-align: center; margin-top: 20px; color: #666; display: none;">Chưa có môn sinh nào.</div>
                <div id="attendance-actions" style="text-align: center; margin-top: 20px; display: none;">
                    <button onclick="window.saveDailyAttendance()" class="btn-save-attendance"><i class="fas fa-save"></i> Lưu Điểm Danh Hôm Nay</button>
                </div>
            </div>
        </section>

        <section id="history-section" style="display: none;"><h2 id="history-title" class="section-title">Lịch Sử</h2><div id="history-filters" class="history-controls" style="display: none;"><div class="control-group"><label>Ngày:</label><input type="date" id="history-date-picker" onchange="window.loadHistoryData()"></div><div class="control-group"><label>CLB:</label><select id="history-club-select" onchange="window.loadHistoryData()"><option value="Nguyễn Huệ">Nguyễn Huệ</option><option value="Lê Hữu Trác">Lê Hữu Trác</option><option value="Nội Trú">Nội Trú</option><option value="Y Ngông">Y Ngông</option><option value="Hùng Vương">Hùng Vương</option></select></div><button onclick="window.loadHistoryData()" class="btn-refresh"><i class="fas fa-sync"></i></button></div><div class="table-responsive"><table class="history-table"><thead><tr><th>Ngày</th><th>Môn Sinh</th><th>TT</th><th>Ghi chú</th></tr></thead><tbody id="history-list"></tbody></table></div><p id="history-loading" style="display:none;text-align:center;">Đang tải...</p><p id="history-empty" style="display:none;text-align:center;">Không có dữ liệu.</p></section>
        
        <section id="news" style="display: none;"><div class="news-header"><h2>Tin Tức</h2><button id="btn-create-post" onclick="window.togglePostForm()" class="btn-create-news" style="display: none;"><i class="fas fa-pen"></i> Đăng bài</button></div><div id="news-filter-area" class="news-filters" style="display: none;"><label><input type="checkbox" value="Global" checked onchange="window.renderNews()"> Tin chung</label><label><input type="checkbox" value="Nguyễn Huệ" checked onchange="window.renderNews()"> NH</label><label><input type="checkbox" value="Lê Hữu Trác" checked onchange="window.renderNews()"> LHT</label><label><input type="checkbox" value="Nội Trú" checked onchange="window.renderNews()"> NT</label><label><input type="checkbox" value="Y Ngông" checked onchange="window.renderNews()"> YN</label><label><input type="checkbox" value="Hùng Vương" checked onchange="window.renderNews()"> HV</label></div><div id="post-creator" style="display: none;"><h3>Soạn thảo</h3><div class="form-group"><select id="post-target-club" style="width: 100%; padding: 8px;"><option value="Global">Toàn bộ</option><option value="Nguyễn Huệ">Nguyễn Huệ</option><option value="Lê Hữu Trác">Lê Hữu Trác</option><option value="Nội Trú">Nội Trú</option><option value="Y Ngông">Y Ngông</option><option value="Hùng Vương">Hùng Vương</option></select></div><input type="text" id="post-title" placeholder="Tiêu đề..." class="post-input"><div class="rich-editor-toolbar"><button onclick="window.formatDoc('bold')"><b>B</b></button><button onclick="window.formatDoc('italic')"><i>I</i></button><button onclick="window.formatDoc('underline')"><u>U</u></button><label for="media-upload" class="btn-tool-media"><i class="fas fa-photo-video"></i></label><input type="file" id="media-upload" accept="image/*, video/*" style="display: none;" onchange="window.handleMediaUpload(this)"></div><div id="post-content" class="post-editor" contenteditable="true"></div><button onclick="window.publishPost()" class="btn-submit">Đăng</button></div><div id="news-list-view"><div id="news-feed"></div></div><div id="news-detail-view" style="display: none;"><button onclick="window.backToNewsList()" class="btn-back-custom">Quay lại</button><div class="article-container"><h1 id="detail-title"></h1><small id="detail-date"></small><hr><div id="detail-content" class="article-content"></div></div><div class="comment-section"><h3>Bình luận</h3><div id="comment-list"></div><div class="comment-input-wrapper"><div class="comment-toolbar"><button onclick="window.formatComment('bold')"><b>B</b></button><button onclick="window.formatComment('italic')"><i>I</i></button></div><div id="comment-input-rich" contenteditable="true" placeholder="Viết bình luận..."></div><button onclick="window.submitComment()" class="btn-send-comment">Gửi</button></div></div></div></section>
        
        <section id="shop" style="display: none;"><div class="shop-header"><h2>Cửa Hàng</h2><div class="cart-summary"><i class="fas fa-shopping-cart"></i> <span id="cart-count">0</span></div></div><div class="shop-container"><div class="product-grid"><div class="product-card"><img src="https://vovinam.vn/wp-content/uploads/2019/04/vo-phuc-vovinam-1.jpg"><h4>Võ Phục</h4><p class="price">250k</p><button class="btn-add-cart" onclick="alert('Đã thêm!')">Mua</button></div><div class="product-card"><img src="https://tanvietco.com/wp-content/uploads/2015/12/dai-vovinam-cac-loai.jpg"><h4>Đai</h4><p class="price">80k</p><button class="btn-add-cart" onclick="alert('Đã thêm!')">Mua</button></div></div><div class="shop-notice"><p>* Liên hệ HLV để mua.</p></div></div></section>

        <section id="profile" style="display: none;">
            <div class="profile-container">
                <div class="profile-header"><div class="avatar-wrapper"><img id="profile-img-preview" class="profile-avatar-large" src=""><label for="profile-avatar-upload" id="btn-change-avatar" class="btn-upload-avatar" style="display: none;"><i class="fas fa-camera"></i></label><input type="file" id="profile-avatar-upload" style="display: none;" accept="image/*" onchange="window.previewProfileAvatar(this)"></div><h2>Hồ Sơ</h2></div>
                <form id="profile-form">
                    <div class="form-group"><label>Họ tên:</label><input type="text" id="profile-name" disabled></div>
                    <div class="form-group"><label>SĐT:</label><input type="text" id="profile-phone" disabled style="background-color: #e9ecef;"></div>
                    <div class="form-group"><label>Ngày sinh:</label><input type="date" id="profile-dob" disabled></div>
                    <div class="form-group"><label>CLB:</label><input type="text" id="profile-club" disabled style="background-color: #e9ecef;"></div>
                    <div class="form-group"><label>Cấp đai:</label><input type="text" id="profile-belt" disabled style="background-color: #fffde7;font-weight:bold;"></div>
                    <div class="form-group"><label>Lớp:</label><input type="text" id="profile-class" disabled style="background-color: #e9ecef;"></div>
                    <div class="profile-actions"><button type="button" id="btn-edit-profile" class="btn-edit" onclick="window.enableEditProfile()">Sửa</button><button type="button" id="btn-save-profile" class="btn-save" style="display: none;" onclick="window.saveProfile()">Lưu</button></div>
                </form>
            </div>
        </section>

        <div id="modal-edit-student" class="modal">
            <div class="modal-content">
                <span class="close-modal" onclick="window.closeEditModal()">&times;</span>
                <h3>Chỉnh Sửa Thông Tin</h3>
                <form id="form-edit-student" onsubmit="window.saveStudentEdits(event)">
                    <input type="hidden" id="edit-id">
                    <div class="form-group"><label>Họ tên:</label><input type="text" id="edit-name" required></div>
                    <div class="form-group"><label>SĐT:</label><input type="number" id="edit-phone" required></div>
                    <div class="form-group"><label>Ngày sinh:</label><input type="date" id="edit-dob" required></div>
                    <div class="form-group"><label>Cấp đai:</label><select id="edit-belt" required><option value="Tự vệ">Tự vệ</option><option value="Lam đai">Lam đai</option><option value="Lam đai I">Lam đai I</option><option value="Lam đai II">Lam đai II</option><option value="Lam đai III">Lam đai III</option><option value="Chuẩn hoàng đai">Chuẩn hoàng đai</option><option value="Hoàng đai">Hoàng đai</option><option value="Hoàng đai I">Hoàng đai I</option></select></div>
                    <div class="form-group" id="edit-class-wrapper"><label>Lớp (Nội Trú):</label><select id="edit-class"><option value="">-- Không --</option><option value="6">Lớp 6</option><option value="7">Lớp 7</option><option value="8">Lớp 8</option><option value="9">Lớp 9</option></select></div>
                    
                    <div class="form-group" id="div-edit-role" style="display: none;">
                        <label style="color: red; font-weight:bold;">Chức vụ:</label>
                        <select id="edit-role" style="width: 100%; padding: 8px; border: 1px solid red; font-weight: bold;">
                            <option value="student">Môn sinh</option>
                            <option value="monitor">Lớp trưởng (Nội Trú)</option>
                            <option value="assistant">Hướng dẫn viên</option>
                        </select>
                    </div>

                    <div class="form-group"><label>Ảnh (Dưới 5MB):</label><div style="text-align: center;"><img id="edit-img-preview" src="" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover;"></div><input type="file" id="edit-img-upload" accept="image/*" onchange="window.previewEditAvatar(this)"></div>
                    <button type="submit" class="btn-submit">Lưu Thay Đổi</button>
                </form>
            </div>
        </div>

        <div id="modal-banner-manager" class="modal">
            <div class="modal-content"><span class="close-modal" onclick="window.closeBannerManager()">&times;</span><h3>Cài đặt Banner</h3><div class="banner-upload-form" style="background:#f4f4f4; padding:15px; border-radius:5px; margin-bottom:15px;"><div class="form-group"><label>Ảnh mới (Dưới 5MB):</label><input type="file" id="new-banner-img" accept="image/*"></div><div class="form-group"><label>Tiêu đề:</label><input type="text" id="new-banner-title" placeholder="Tiêu đề..."></div><div class="form-group"><label>Mô tả:</label><input type="text" id="new-banner-desc" placeholder="Mô tả..."></div><button class="btn-submit" onclick="window.addBanner()">Thêm</button></div><div class="current-banners-list" id="banner-list-admin" style="max-height:300px; overflow-y:auto;"></div></div>
        </div>

    </main>

    <footer><p>Liên hệ BCN: 0922904904</p><p>&copy; Vovinam Ea M'droh</p></footer>

    <script type="module" src="script.js?v=19.0"></script>
</body>
</html>
